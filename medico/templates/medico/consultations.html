{% extends "medico/base.html" %}
{% load django_bootstrap5 %}

{% block title %}Détail de la consultation de {{ consultation.patient_prenom }} {{ consultation.patient_nom }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <h2 class="card-title mb-3">
                    Consultation de {{ consultation.patient_prenom }} {{ consultation.patient_nom }}
                </h2>

                <ul class="list-group mb-4">
                    <li class="list-group-item"><strong>Genre :</strong> {{ consultation.patient_genre }}</li>
                    <li class="list-group-item"><strong>Âge :</strong> {{ consultation.patient_age }} ans</li>
                    <li class="list-group-item"><strong>Date :</strong> {{ consultation.date_consultation }}</li>
                    <li class="list-group-item"><strong>Description :</strong> {{ consultation.description }}</li>
                </ul>

                <div class="d-flex gap-2 mb-3">
                    <a href="{% url 'nouveau_traitement' consultation.id %}" class="btn btn-success flex-grow-1">Nouveau traitement</a>
                    <a href="{% url 'consultations' %}" class="btn btn-secondary flex-grow-1">Retour à la liste</a>
                </div>
            </div>
        </div>
    </div>
</div>

<hr>

<div class="accordion mt-4" id="traitementsAccordion">
    {% for traitement in traitements %}
    <div class="accordion-item">
        <h2 class="accordion-header" id="heading{{ traitement.id }}">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ traitement.id }}" aria-expanded="false" aria-controls="collapse{{ traitement.id }}">
                {{ traitement.medicament }}
            </button>
        </h2>
    <div id="collapse{{ traitement.id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ traitement.id }}" data-bs-parent="#traitementsAccordion">
        <div class="accordion-body">
            <p><strong>Contenant :</strong> {{ traitement.contenant }}</p>
            <p><strong>Durée :</strong> {{ traitement.duree_en_jours }} jours</p>
            <p><strong>Dosage journalier :</strong> {{ traitement.dosage }}</p>
            <p><strong>Instructions :</strong> {{ traitement.instructions_utilisations }}</p>

        <div class="mt-3 d-flex gap-2">
            <button class="btn btn-sm btn-warning" disabled>Modifier</button>
            <button class="btn btn-sm btn-danger" disabled>Supprimer</button>
        </div>
    </div>
</div>
    </div>
    {% empty %}
        <p class="text-center">Aucun traitement associé à cette consultation.</p>
    {% endfor %}
</div>


{% endblock %}
